<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1> Welcome <span id="user-name"></span> </h1>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script>
        $(document).ready(function() {

            // Check for access token and user information in localStorage
            const accessToken = localStorage.getItem("access");
            const userInfoString = localStorage.getItem("User");

            // Parse user information if it exists
            let userInfo;
            try {
            userInfo = JSON.parse(userInfoString);
            } catch (error) {
            userInfo = null; // Handle potential parsing errors
            }

            console.log(userInfo)

            // Redirect to login if no access token or user information
            if (!accessToken || !userInfo) {
            window.location.href = "{% url 'login' %}";
            return; // Exit the function if redirected
            }

            // Access granted, use user information (example)
            console.log("Welcome,", userInfo.name, "Your email is", userInfo.email);

            // Your dashboard functionalities here (assuming user is authenticated)
            
            const userNameSpan = document.getElementById("user-name");
            userNameSpan.textContent = userInfo.name; // Set text content

            });

    </script>
</body>
</html>